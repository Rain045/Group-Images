# Image Similarity Pro - 圖片相似度分組神器 🚀

這是一款基於 PyQt6 打造的專業級圖片去重與相似度分組工具。採用現代化的「左右分欄」設計，並整合了 **感知哈希 (ImageHash)**、**特徵點匹配 (OpenCV)** 以及 **深度學習 (AI Models)** 三大核心引擎，讓你能夠應付從簡單的格式轉換到複雜的視角裁切等各種圖片比對需求。

---

## ✨ 核心特色功能

* 🖥️ **專業級 UI 介面**：採用左側控制面板、右側無限預覽區的現代化佈局。
* 🔍 **點擊檢視大圖 (Lightbox)**：滑鼠點擊預覽縮圖，即可自動適應螢幕大小彈出高畫質原圖。
* 🧠 **三合一分析引擎**：可自由切換 ImageHash、OpenCV ORB 或多種 AI 神經網路。
* 📊 **動態進度追蹤**：真實的進度條顯示，處理上千張圖片絕不卡死 (多執行緒架構)。
* 📂 **無損操作模式**：支援「複製」與「移動」雙模式，並將無相似項的圖片自動歸類至 `single` 資料夾。

---

## 🛠️ 環境與安裝指南

請確保你的電腦已安裝 Python 3.8 以上版本。開啟終端機 (Terminal) 或命令提示字元 (CMD)，執行以下指令安裝依賴套件：

```bash
pip install PyQt6 Pillow imagehash opencv-python numpy torch torchvision scikit-learn
```

> **注意**：PyTorch 套件較大，下載可能需要數分鐘。初次使用 AI 引擎時，程式會自動於背景下載該模型的預訓練權重（約 15MB~100MB 不等）。

---

## 🚀 使用說明

1. 執行主程式：
   ```bash
   python ImageSimilarityGUI.py
   ```
2. 在左側面板選擇**輸入資料夾**（你要掃描的照片）與**輸出資料夾**。
3. 選擇適合的**分析引擎**並調整閾值（詳見下方引擎指南）。
4. 點擊 **「開始掃描與預覽」**。
5. 在右側查看分組結果。你可以取消勾選不想歸類在一起的群組，也可以點擊縮圖查看原圖。
6. 確認無誤後，點擊左下角的 **「確認執行分組」** 進行檔案移動或複製。

---

## 🧠 核心引擎與參數設定指南

本工具提供三種不同維度的比對演算法，請依據你的圖片特性進行選擇：

### 1. ⚡ 雙重感知哈希 (ImageHash) - 速度最快
* **原理**：將圖片縮小並轉換為灰階，比較結構與色彩的分佈。
* **最佳場景**：尋找完全一樣的圖片、被壓縮過的圖片、或是改變解析度的圖片。
* **參數建議**：
  * **結構 (Shape)**：預設 10。越小越嚴格（0 代表完全一致）。
  * **色彩 (Color)**：預設 10。越小代表顏色差異越小。

### 2. 🧬 OpenCV ORB 特徵匹配 - 抗裁切神器
* **原理**：尋找圖片中的關鍵邊角與紋理（特徵點），並進行交叉比對。
* **最佳場景**：圖片被大量裁切、加上了邊框、或是主角位置偏移。
* **參數建議**：
  * **最低匹配點**：預設 50。數值越高代表要求越嚴格，如果發現誤判，請調高至 70-100；如果漏判，請降至 30-40。

### 3. 🤖 AI 語義特徵 (Deep Learning) - 終極精準
* **原理**：使用卷積神經網路 (CNN) 理解圖片的「語義」（例如：這是一隻狗），並計算高維度向量的餘弦相似度。
* **最佳場景**：同一個場景的連拍、加上濾鏡的圖片、甚至不同角度的同一物體。
* **模型選擇**：
  * `mobilenet_v2` (輕量)：速度極快，適合一般 CPU，準確率高。
  * `resnet18` (輕量)：經典網路，速度與準確度平衡。
  * `efficientnet_b0` (輕量)：較新的架構，特徵提取更細膩。
  * `resnet50` (中型)：擁有更深層的網路，細節辨識度極高。
  * `efficientnet_b2` (中型)：精準度極高，適合處理複雜場景。
* **參數建議**：
  * **相似度**：建議設定在 `0.90` 到 `0.95` 之間。`0.98` 代表幾乎完全一致，`0.85` 可能會將同類別但不同物體的圖片分在一起。

---

## 📝 注意事項
* 若有中文路徑讀取問題，OpenCV 引擎已優化使用 `numpy` 讀取，可完美支援中文字元。
* AI 引擎預設使用 `CPU` 運算，即使沒有獨立顯卡也能順暢運行。
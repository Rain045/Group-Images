# Image Similarity Pro (美感篩選版)

**Image Similarity Pro** 是一款基於 PyQt6 開發的桌面應用程式，旨在幫助使用者快速找出資料夾中相似的圖片，並透過**混合式 AI 與電腦視覺 (CV) 美感評分系統**，自動為每組相似圖片挑選出「最佳照片」。其餘品質較低的圖片可以一鍵移至資源回收筒 (Trash 資料夾)，是整理大量照片、連拍圖的絕佳工具。

---

## ✨ 核心功能

* **🕵️‍♂️ 多重相似度比對引擎：**
    * **🧠 AI 語義特徵：** 支援多種預訓練神經網路 (ResNet18, MobileNet_V2, EfficientNet_B0/B2, ResNet50) 提取特徵，透過餘弦相似度 (Cosine Similarity) 進行高維度語義比對。
    * **🧬 OpenCV ORB：** 提取圖片特徵點並使用暴力匹配法 (Brute-Force Matcher) 進行比對，適合尋找局部特徵相似的圖片。
    * **⚡ 雙重感知哈希 (ImageHash)：** 結合結構哈希 (pHash) 與色彩哈希 (colorhash) 進行雙重交叉比對，速度快且精準。
* **🏆 混合式美感與品質評分 (Aesthetic Scoring)：**
    * **AI 語義評分 (70%)：** 整合 OpenAI 的 CLIP 模型 (clip-vit-base-patch32)，根據「高品質專業照片」與「低品質模糊照片」的文本提示，評估圖片的整體構圖與語義美感。
    * **傳統 CV 評分 (30%)：** 使用 OpenCV 演算法分析圖片的清晰度 (Laplacian 變異數)、對比度、色彩豐富度，並加入曝光平衡懲罰。
* **🖥️ 現代化圖形介面 (GUI)：**
    * 採用 PyQt6 打造，支援直覺的參數調整與視覺化進度條。
    * 提供巨大的右側圖片預覽區，群組化顯示相似圖片，並標示「👑 最佳」與「🗑️ 待刪」。
    * 支援點擊圖片放大檢視。
* **🛡️ 安全的檔案管理：**
    * 所有刪除操作均為「移至 Trash 資料夾」，不會直接永久刪除檔案，保障資料安全。支援單組處理與一鍵批量處理。

---

## 🛠️ 安裝與環境建置

請確保您的系統已安裝 Python 3.8 或以上版本。

### 1. 安裝系統依賴套件
本程式依賴多個機器學習與影像處理的開源函式庫。請在終端機 (或命令提示字元) 輸入以下指令安裝：

    pip install PyQt6 Pillow ImageHash opencv-python numpy scikit-learn
    pip install torch torchvision
    pip install transformers

(註：若您具備 NVIDIA GPU，建議前往 PyTorch 官網安裝對應 CUDA 版本的 PyTorch，以獲得最佳的模型推理速度；若為 Mac 使用者，程式會自動嘗試調用 MPS 進行硬體加速。)

### 2. 執行程式
在終端機或命令提示字元中，切換到程式所在目錄，執行以下指令啟動應用程式：

    python ImageSimilarityGUI.py

---

## 🚀 使用指南

1. **選擇目錄：** 點擊左上方「📁 檔案目錄設定」旁的資料夾圖示，選擇您要掃描的圖片資料夾。
2. **選擇引擎與參數：**
    * 在「分析引擎」下拉選單選擇您偏好的比對方式 (AI 語義特徵、OpenCV ORB 或 雙重感知哈希)。
    * 根據選擇的引擎，微調下方的參數 (例如：AI 的相似度閾值、OpenCV 的最低匹配點數、或哈希的容錯值)。
3. **開始掃描：** 點擊「🔍 開始掃描與美感評估」。程式會在背景載入模型、比對圖片並進行美感打分。
4. **預覽與處理：**
    * 掃描完成後，右側會顯示分組結果。系統會根據美感與品質總分，將該組最高分的圖片排在最前面，標示為「👑 最佳」。
    * 您可以點擊單張圖片查看大圖。
    * 點擊單組下方的「🗑️ 處理此組」來清理特定群組（保留最佳，其餘移至 Trash），或點擊左側面板的「✅ 批量處理所有組」一鍵處理所有掃描到的群組。

---

## ⚠️ 注意事項

* **模型自動下載：** 初次使用 AI 相似度比對引擎或啟動美感評估時，程式會從 Hugging Face 下載所需的預訓練模型 (如 resnet18, openai/clip-vit-base-patch32)。請確保網路暢通，下載時間視網路速度而定。
* **硬體資源消耗：** AI 模型推理會消耗較多的 CPU/RAM 或 VRAM 資源。若掃描大量高解析度圖片，建議使用具備 GPU 的設備運行以提升效率。
* **支援格式：** 程式目前支援讀取 .jpg, .jpeg, .png, .bmp, .webp, .tiff 等主流影像格式 (支援中文路徑讀取)。